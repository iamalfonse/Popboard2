/*
 Copyright (c) 2003-2014, CKSource - Frederico Knabben. All rights reserved.
 For licensing, see LICENSE.md or http://ckeditor.com/license
*/
!function(){var a=function(a,b){function c(){var a=arguments,b=this.getContentElement("advanced","txtdlgGenStyle");b&&b.commit.apply(b,a),this.foreach(function(b){b.commit&&"txtdlgGenStyle"!=b.id&&b.commit.apply(b,a)})}function d(a){if(!k){k=1;var b=this.getDialog(),c=b.imageElement;if(c){this.commit(e,c);for(var f,a=[].concat(a),d=a.length,g=0;d>g;g++)(f=b.getContentElement.apply(b,a[g].split(":")))&&f.setup(e,c)}k=0}}var k,o,e=1,f=/^\s*(\d+)((px)|\%)?\s*$/i,j=function(a){return a.originalElement&&a.preview?(a.commitContent(4,a.preview),0):1},l=function(a,b){if(!a.getContentElement("info","ratioLock"))return null;var c=a.originalElement;if(!c)return null;if("check"==b){if(!a.userlockRatio&&"true"==c.getCustomData("isReady")){var d=a.getValueOf("info","txtWidth"),e=a.getValueOf("info","txtHeight"),c=1e3*c.$.width/c.$.height,f=1e3*d/e;a.lockRatio=!1,d||e?!isNaN(c)&&!isNaN(f)&&Math.round(c)==Math.round(f)&&(a.lockRatio=!0):a.lockRatio=!0}}else void 0!=b?a.lockRatio=b:(a.userlockRatio=1,a.lockRatio=!a.lockRatio);return d=CKEDITOR.document.getById(s),a.lockRatio?d.removeClass("cke_btn_unlocked"):d.addClass("cke_btn_unlocked"),d.setAttribute("aria-checked",a.lockRatio),CKEDITOR.env.hc&&d.getChild(0).setHtml(a.lockRatio?CKEDITOR.env.ie?"\u25a0":"\u25a3":CKEDITOR.env.ie?"\u25a1":"\u25a2"),a.lockRatio},m=function(a){var b=a.originalElement;if("true"==b.getCustomData("isReady")){var c=a.getContentElement("info","txtWidth"),d=a.getContentElement("info","txtHeight");c&&c.setValue(b.$.width),d&&d.setValue(b.$.height)}j(a)},p=function(){var a=this.originalElement;a.setCustomData("isReady","true"),a.removeListener("load",p),a.removeListener("error",q),a.removeListener("abort",q),CKEDITOR.document.getById(u).setStyle("display","none"),this.dontResetSize||m(this),this.firstLoad&&CKEDITOR.tools.setTimeout(function(){l(this,"check")},0,this),this.dontResetSize=this.firstLoad=!1},q=function(){var a=this.originalElement;a.removeListener("load",p),a.removeListener("error",q),a.removeListener("abort",q),a=CKEDITOR.getUrl(CKEDITOR.plugins.get("image").path+"images/noimage.png"),this.preview&&this.preview.setAttribute("src",a),CKEDITOR.document.getById(u).setStyle("display","none"),l(this,!1)},r=function(a){return CKEDITOR.tools.getNextId()+"_"+a},s=r("btnLockSizes"),t=r("btnResetSize"),u=r("ImagePreviewLoader"),v=r("previewLink"),w=r("previewImage");return{title:a.lang.image["image"==b?"title":"titleButton"],minWidth:420,minHeight:360,onShow:function(){this.linkEditMode=this.imageEditMode=this.linkElement=this.imageElement=!1,this.lockRatio=!0,this.userlockRatio=0,this.dontResetSize=!1,this.firstLoad=!0,this.addLink=!1;var a=this.getParentEditor(),c=a.getSelection(),d=(c=c&&c.getSelectedElement())&&a.elementPath(c).contains("a",1);if(CKEDITOR.document.getById(u).setStyle("display","none"),o=new CKEDITOR.dom.element("img",a.document),this.preview=CKEDITOR.document.getById(w),this.originalElement=a.document.createElement("img"),this.originalElement.setAttribute("alt",""),this.originalElement.setCustomData("isReady","false"),d){this.linkElement=d,this.linkEditMode=!0;var f=d.getChildren();if(1==f.count()){var g=f.getItem(0).getName();("img"==g||"input"==g)&&(this.imageElement=f.getItem(0),"img"==this.imageElement.getName()?this.imageEditMode="img":"input"==this.imageElement.getName()&&(this.imageEditMode="input"))}"image"==b&&this.setupContent(2,d)}this.customImageElement?(this.imageEditMode="img",this.imageElement=this.customImageElement,delete this.customImageElement):(c&&"img"==c.getName()&&!c.data("cke-realelement")||c&&"input"==c.getName()&&"image"==c.getAttribute("type"))&&(this.imageEditMode=c.getName(),this.imageElement=c),this.imageEditMode?(this.cleanImageElement=this.imageElement,this.imageElement=this.cleanImageElement.clone(!0,!0),this.setupContent(e,this.imageElement)):this.imageElement=a.document.createElement("img"),l(this,!0),CKEDITOR.tools.trim(this.getValueOf("info","txtUrl"))||(this.preview.removeAttribute("src"),this.preview.setStyle("display","none"))},onOk:function(){if(this.imageEditMode){var c=this.imageEditMode;"image"==b&&"input"==c&&confirm(a.lang.image.button2Img)?(this.imageElement=a.document.createElement("img"),this.imageElement.setAttribute("alt",""),a.insertElement(this.imageElement)):"image"!=b&&"img"==c&&confirm(a.lang.image.img2Button)?(this.imageElement=a.document.createElement("input"),this.imageElement.setAttributes({type:"image",alt:""}),a.insertElement(this.imageElement)):(this.imageElement=this.cleanImageElement,delete this.cleanImageElement)}else"image"==b?this.imageElement=a.document.createElement("img"):(this.imageElement=a.document.createElement("input"),this.imageElement.setAttribute("type","image")),this.imageElement.setAttribute("alt","");this.linkEditMode||(this.linkElement=a.document.createElement("a")),this.commitContent(e,this.imageElement),this.commitContent(2,this.linkElement),this.imageElement.getAttribute("style")||this.imageElement.removeAttribute("style"),this.imageEditMode?!this.linkEditMode&&this.addLink?(a.insertElement(this.linkElement),this.imageElement.appendTo(this.linkElement)):this.linkEditMode&&!this.addLink&&(a.getSelection().selectElement(this.linkElement),a.insertElement(this.imageElement)):this.addLink?this.linkEditMode?a.insertElement(this.imageElement):(a.insertElement(this.linkElement),this.linkElement.append(this.imageElement,!1)):a.insertElement(this.imageElement)},onLoad:function(){"image"!=b&&this.hidePage("Link");var a=this._.element.getDocument();this.getContentElement("info","ratioLock")&&(this.addFocusable(a.getById(t),5),this.addFocusable(a.getById(s),5)),this.commitContent=c},onHide:function(){this.preview&&this.commitContent(8,this.preview),this.originalElement&&(this.originalElement.removeListener("load",p),this.originalElement.removeListener("error",q),this.originalElement.removeListener("abort",q),this.originalElement.remove(),this.originalElement=!1),delete this.imageElement},contents:[{id:"info",label:a.lang.image.infoTab,accessKey:"I",elements:[{type:"vbox",padding:0,children:[{type:"hbox",widths:["280px","110px"],align:"right",children:[{id:"txtUrl",type:"text",label:a.lang.common.url,required:!0,onChange:function(){var a=this.getDialog(),b=this.getValue();if(0<b.length){var a=this.getDialog(),c=a.originalElement;a.preview.removeStyle("display"),c.setCustomData("isReady","false");var d=CKEDITOR.document.getById(u);d&&d.setStyle("display",""),c.on("load",p,a),c.on("error",q,a),c.on("abort",q,a),c.setAttribute("src",b),o.setAttribute("src",b),a.preview.setAttribute("src",o.$.src),j(a)}else a.preview&&(a.preview.removeAttribute("src"),a.preview.setStyle("display","none"))},setup:function(a,b){if(a==e){var c=b.data("cke-saved-src")||b.getAttribute("src");this.getDialog().dontResetSize=!0,this.setValue(c),this.setInitValue()}},commit:function(a,b){a==e&&(this.getValue()||this.isChanged())?(b.data("cke-saved-src",this.getValue()),b.setAttribute("src",this.getValue())):8==a&&(b.setAttribute("src",""),b.removeAttribute("src"))},validate:CKEDITOR.dialog.validate.notEmpty(a.lang.image.urlMissing)},{type:"button",id:"browse",style:"display:inline-block;margin-top:10px;",align:"center",label:a.lang.common.browseServer,hidden:!0,filebrowser:"info:txtUrl"}]}]},{type:"vbox",height:"250px",children:[{type:"html",id:"htmlPreview",style:"width:100%;",html:"<div>"+CKEDITOR.tools.htmlEncode(a.lang.common.preview)+'<br><div id="'+u+'" class="ImagePreviewLoader" style="display:none"><div class="loading">&nbsp;</div></div><div class="ImagePreviewBox" ><table><tr><td><a href="javascript:void(0)" target="_blank" onclick="return false;" id="'+v+'"><img id="'+w+'" alt="" style="width: 100%;"/></a>'+(a.config.image_previewText||"")+"</td></tr></table></div></div>"}]}]},{id:"Link",requiredContent:"a[href]",label:a.lang.image.linkTab,padding:0,elements:[{id:"txtUrl",type:"text",label:a.lang.common.url,style:"width: 100%","default":"",setup:function(a,b){if(2==a){var c=b.data("cke-saved-href");c||(c=b.getAttribute("href")),this.setValue(c)}},commit:function(b,c){if(2==b&&(this.getValue()||this.isChanged())){var d=decodeURI(this.getValue());c.data("cke-saved-href",d),c.setAttribute("href",d),(this.getValue()||!a.config.image_removeLinkByEmptyURL)&&(this.getDialog().addLink=!0)}}},{type:"button",id:"browse",filebrowser:{action:"Browse",target:"Link:txtUrl",url:a.config.filebrowserImageBrowseLinkUrl},style:"float:right",hidden:!0,label:a.lang.common.browseServer},{id:"cmbTarget",type:"select",requiredContent:"a[target]",label:a.lang.common.target,"default":"",items:[[a.lang.common.notSet,""],[a.lang.common.targetNew,"_blank"],[a.lang.common.targetTop,"_top"],[a.lang.common.targetSelf,"_self"],[a.lang.common.targetParent,"_parent"]],setup:function(a,b){2==a&&this.setValue(b.getAttribute("target")||"")},commit:function(a,b){2==a&&(this.getValue()||this.isChanged())&&b.setAttribute("target",this.getValue())}}]},{id:"Upload",hidden:!0,filebrowser:"uploadButton",label:a.lang.image.upload,elements:[{type:"file",id:"upload",label:a.lang.image.btnUpload,style:"height:40px",size:38},{type:"fileButton",id:"uploadButton",filebrowser:"info:txtUrl",label:a.lang.image.btnUpload,"for":["Upload","upload"]}]},{id:"advanced",label:a.lang.common.advancedTab,elements:[{type:"hbox",widths:["50%","25%","25%"],children:[{type:"text",id:"linkId",requiredContent:"img[id]",label:a.lang.common.id,setup:function(a,b){a==e&&this.setValue(b.getAttribute("id"))},commit:function(a,b){a==e&&(this.getValue()||this.isChanged())&&b.setAttribute("id",this.getValue())}},{id:"cmbLangDir",type:"select",requiredContent:"img[dir]",style:"width : 100px;",label:a.lang.common.langDir,"default":"",items:[[a.lang.common.notSet,""],[a.lang.common.langDirLtr,"ltr"],[a.lang.common.langDirRtl,"rtl"]],setup:function(a,b){a==e&&this.setValue(b.getAttribute("dir"))},commit:function(a,b){a==e&&(this.getValue()||this.isChanged())&&b.setAttribute("dir",this.getValue())}},{type:"text",id:"txtLangCode",requiredContent:"img[lang]",label:a.lang.common.langCode,"default":"",setup:function(a,b){a==e&&this.setValue(b.getAttribute("lang"))},commit:function(a,b){a==e&&(this.getValue()||this.isChanged())&&b.setAttribute("lang",this.getValue())}}]},{type:"text",id:"txtGenLongDescr",requiredContent:"img[longdesc]",label:a.lang.common.longDescr,setup:function(a,b){a==e&&this.setValue(b.getAttribute("longDesc"))},commit:function(a,b){a==e&&(this.getValue()||this.isChanged())&&b.setAttribute("longDesc",this.getValue())}},{type:"hbox",widths:["50%","50%"],children:[{type:"text",id:"txtGenClass",requiredContent:"img(cke-xyz)",label:a.lang.common.cssClass,"default":"",setup:function(a,b){a==e&&this.setValue(b.getAttribute("class"))},commit:function(a,b){a==e&&(this.getValue()||this.isChanged())&&b.setAttribute("class",this.getValue())}},{type:"text",id:"txtGenTitle",requiredContent:"img[title]",label:a.lang.common.advisoryTitle,"default":"",onChange:function(){j(this.getDialog())},setup:function(a,b){a==e&&this.setValue(b.getAttribute("title"))},commit:function(a,b){a==e?(this.getValue()||this.isChanged())&&b.setAttribute("title",this.getValue()):4==a?b.setAttribute("title",this.getValue()):8==a&&b.removeAttribute("title")}}]},{type:"text",id:"txtdlgGenStyle",requiredContent:"img{cke-xyz}",label:a.lang.common.cssStyle,validate:CKEDITOR.dialog.validate.inlineStyle(a.lang.common.invalidInlineStyle),"default":"",setup:function(a,b){if(a==e){var c=b.getAttribute("style");!c&&b.$.style.cssText&&(c=b.$.style.cssText),this.setValue(c);var d=b.$.style.height,c=b.$.style.width,d=(d?d:"").match(f),c=(c?c:"").match(f);this.attributesInStyle={height:!!d,width:!!c}}},onChange:function(){d.call(this,"info:cmbFloat info:cmbAlign info:txtVSpace info:txtHSpace info:txtBorder info:txtWidth info:txtHeight".split(" ")),j(this)},commit:function(a,b){a==e&&(this.getValue()||this.isChanged())&&b.setAttribute("style",this.getValue())}}]}]}};CKEDITOR.dialog.add("image",function(b){return a(b,"image")}),CKEDITOR.dialog.add("imagebutton",function(b){return a(b,"imagebutton")})}();